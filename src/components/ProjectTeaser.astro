---
import { getCollection } from 'astro:content';
import FormattedDate from './FormattedDate.astro';
import { Image } from 'astro:assets';

const projects = (await getCollection('projects'))
  .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
  .slice(0, 3);
---

<section class="project-preview">
        <div class="width-container">
            <h2>Neu im Portfolio</h2>
            <ul>
              {
                projects.map((project) => (
                  <li>
                    <a href={`/projects/${project.id}/`}>
                      {project.data.image && (
                        <Image src={project.data.image} width={400} height={200} alt="" />
                      )}
                      <h3>{project.data.title}</h3>
                      <p class="date">
                        <FormattedDate date={project.data.pubDate} />
                      </p>
                    </a>
                  </li>
                ))
              }
            </ul>
            <p class="more-link">
              <a href="/projects">Alle Projekte ansehen â†’</a>
            </p>

        </div>
</section>

<style>
.project-preview {
  margin-top: 4rem;
}
.project-preview ul {
  list-style: none;
  padding: 0;
  display: flex;
  flex-wrap: wrap;
  gap: 2rem;
}
.project-preview li {
  width: calc(33.333% - 1.333rem);
}
.project-preview a {
  text-decoration: none;
  color: inherit;
}
.project-preview h3 {
  margin: 0.5rem 0 0;
}
.project-preview .date {
  font-size: 0.9rem;
  color: rgb(var(--gray));
}
.more-link {
  margin-top: 1.5rem;
  text-align: right;
}
@media (max-width: 720px) {
  .project-preview li {
    width: 100%;
  }
}
</style>